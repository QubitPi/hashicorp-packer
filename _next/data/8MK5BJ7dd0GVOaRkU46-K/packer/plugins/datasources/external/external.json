{"pageProps":{"layoutProps":{"breadcrumbLinks":[{"title":"Developer","url":"/"},{"title":"Packer","url":"/packer"},{"title":"Plugins","url":"/packer/plugins"},{"title":"datasources"},{"title":"External","key":"joomcode/packer-plugin-external"},{"title":"External","url":"/packer/plugins/datasources/external/external","isCurrentPage":true}],"githubFileUrl":"https://github.com/joomcode/packer-plugin-external/blob/main/docs/datasources/external.mdx","sidebarNavDataLevels":[{"levelButtonProps":{"levelDownButtonText":"Packer Home"},"menuItems":[{"leadingIconName":"home","title":"HashiCorp Developer","href":"/"},{"leadingIconName":"guide","title":"Tutorials","href":"/tutorials"},{"divider":true},{"heading":"Products"},{"leadingIconName":"hcp","title":"HashiCorp Cloud Platform","href":"/hcp"},{"leadingIconName":"terraform","title":"Terraform","href":"/terraform"},{"leadingIconName":"packer","title":"Packer","href":"/packer"},{"leadingIconName":"consul","title":"Consul","href":"/consul"},{"leadingIconName":"vault","title":"Vault","href":"/vault"},{"leadingIconName":"boundary","title":"Boundary","href":"/boundary"},{"leadingIconName":"nomad","title":"Nomad","href":"/nomad"},{"leadingIconName":"waypoint","title":"Waypoint","href":"/waypoint"},{"leadingIconName":"vagrant","title":"Vagrant","href":"/vagrant"}],"showFilterInput":false,"title":"Main Menu"},{"levelButtonProps":{"levelUpButtonText":"Main Menu","levelDownButtonText":"Previous"},"menuItems":[{"title":"Packer","fullPath":"/packer","theme":"packer"},{"title":"Install","fullPath":"/packer/install"},{"title":"Tutorials","fullPath":"/packer/tutorials"},{"title":"Documentation","fullPath":"/packer/docs"},{"title":"Guides","fullPath":"/packer/guides"},{"title":"Plugins","fullPath":"/packer/plugins"},{"title":"Integrations","fullPath":"/packer/integrations"}],"showFilterInput":false,"title":"Packer","visuallyHideTitle":true},{"backToLinkProps":{"text":"Packer Home","href":"/packer"},"levelButtonProps":{"levelUpButtonText":"Packer Home"},"menuItems":[{"title":"Plugins","fullPath":"/packer/plugins","theme":"packer"},{"divider":true,"id":"sidebar-nav-item-2"},{"title":"Anka","routes":[{"title":"Post-Processors","routes":[{"title":"Anka Registry Push","path":"post-processors/anka","remoteFile":{"filePath":"docs/post-processors/anka-registry-push.mdx"},"pluginData":{"title":"Anka","path":"anka","repo":"veertuinc/packer-plugin-veertu-anka","pluginTier":"community","sourceBranch":"master","version":"latest","files":[]},"fullPath":"/packer/plugins/post-processors/anka","id":"sidebar-nav-item-5"}],"id":"sidebar-nav-item-4"},{"title":"Builders","routes":[{"title":"VM Clone","path":"builders/anka/vm-clone","remoteFile":{"filePath":"docs/builders/vm-clone.mdx"},"pluginData":{"title":"Anka","path":"anka","repo":"veertuinc/packer-plugin-veertu-anka","pluginTier":"community","sourceBranch":"master","version":"latest","files":[]},"fullPath":"/packer/plugins/builders/anka/vm-clone","id":"sidebar-nav-item-7"},{"title":"VM Create","path":"builders/anka/vm-create","remoteFile":{"filePath":"docs/builders/vm-create.mdx"},"pluginData":{"title":"Anka","path":"anka","repo":"veertuinc/packer-plugin-veertu-anka","pluginTier":"community","sourceBranch":"master","version":"latest","files":[]},"fullPath":"/packer/plugins/builders/anka/vm-create","id":"sidebar-nav-item-8"}],"id":"sidebar-nav-item-6"}],"id":"sidebar-nav-item-3"},{"title":"DigitalOcean","routes":[{"title":"Builders","routes":[{"title":"digitalocean","path":"builders/digitalocean","remoteFile":{"filePath":"docs/builders/digitalocean.mdx"},"pluginData":{"title":"DigitalOcean","path":"digitalocean","repo":"digitalocean/packer-plugin-digitalocean","pluginTier":"verified","version":"latest","isHcpPackerReady":true,"files":[]},"fullPath":"/packer/plugins/builders/digitalocean","id":"sidebar-nav-item-11"}],"id":"sidebar-nav-item-10"},{"title":"Data Sources","routes":[{"title":"digitalocean-image","path":"datasources/digitalocean","remoteFile":{"filePath":"docs/datasources/digitalocen-image.mdx"},"pluginData":{"title":"DigitalOcean","path":"digitalocean","repo":"digitalocean/packer-plugin-digitalocean","pluginTier":"verified","version":"latest","isHcpPackerReady":true,"files":[]},"fullPath":"/packer/plugins/datasources/digitalocean","id":"sidebar-nav-item-13"}],"id":"sidebar-nav-item-12"},{"title":"Post-Processors","routes":[{"title":"digitalocean-import","path":"post-processors/digitalocean","remoteFile":{"filePath":"docs/post-processors/digitalocean-import.mdx"},"pluginData":{"title":"DigitalOcean","path":"digitalocean","repo":"digitalocean/packer-plugin-digitalocean","pluginTier":"verified","version":"latest","isHcpPackerReady":true,"files":[]},"fullPath":"/packer/plugins/post-processors/digitalocean","id":"sidebar-nav-item-15"}],"id":"sidebar-nav-item-14"}],"id":"sidebar-nav-item-9"},{"title":"External","routes":[{"title":"Data Sources","routes":[{"title":"Overview","path":"datasources/external","remoteFile":{"filePath":"docs/datasources/index.mdx"},"pluginData":{"title":"External","path":"external","repo":"joomcode/packer-plugin-external","version":"latest","sourceBranch":"main","pluginTier":"community","files":[]},"fullPath":"/packer/plugins/datasources/external","id":"sidebar-nav-item-18"},{"title":"External","path":"datasources/external/external","remoteFile":{"filePath":"docs/datasources/external.mdx","fileString":"---\ndescription: >\n  The json data source is used to communicate with external commands\n  using JSON protocol.\npage_title: External - Data Sources\nnav_title: External\n---\n\n# External\n\nType: `external`\n\nThe `external` data source allows an external program implementing a specific\nprotocol (defined below) to act as a data source, exposing arbitrary\ndata for use elsewhere in the Packer configuration.\n\n~> **Warning** This mechanism is provided as an \"escape hatch\" for exceptional\nsituations where a first-class Packer provider is not more appropriate.\nIts capabilities are limited in comparison to a true data source, and\nimplementing a data source via an external program is likely to hurt the\nportability of your Packer configuration by creating dependencies on\nexternal programs and libraries that may not be available (or may need to\nbe used differently) on different operating systems.\n\n### Example Usage\n```hcl\ndata \"external\" \"example\" {\n  program = [\"jq\", \"{ \\\"foo\\\": .key1 }\"]\n  query = {\n    key1 = \"val1\"\n  }\n}\n\nlocals {\n  result = data.external.example.result\n}\n\nsource \"null\" \"example\" {\n  communicator = \"none\"\n}\n\nbuild {\n  sources = [\"source.null.example\"]\n\n  provisioner \"shell-local\" {\n    inline = [\n      \"echo ${local.result[\"foo\"]} == val1\",\n    ]\n  }\n}\n```\n\n## External Program Protocol\n\nThe external program described by the `program` attribute must implement a\nspecific protocol for interacting with Packer, as follows.\n\nThe program must read all the data passed to it on `stdin`, and parse\nit as a JSON object. The JSON object contains the contents of the `query`\nargument and its values will always be strings.\n\nThe program must then produce a valid JSON object on `stdout`, which will\nbe used to populate the `result` attribute exported to the rest of the\nPacker configuration. This JSON object must again have all of its\nvalues as strings. On successful completion it must exit with status zero.\n\nIf the program encounters an error and is unable to produce a result, it\nmust print a human-readable error message (ideally a single line) to `stderr`\nand exit with a non-zero status. Any data on `stdout` is ignored if the\nprogram returns a non-zero status.\n\nAll environment variables visible to the Packer process are passed through\nto the child program.\n\n## Argument Reference\n\n### Required\n\n- `command` ([]string) - A list of strings, whose first element is the program\n  to run and whose subsequent elements are optional command line arguments\n  to the program. Packer does not execute the program through a shell, so\n  it is not necessary to escape shell metacharacters nor add quotes around\n  arguments containing spaces.\n\n### Optional\n\n- `working_dir` (string) - Working directory of the program.\n  If not supplied, the program will run in the current directory.\n- `query` (map[string]string) - A map of string values to pass to the external program\n  as the query arguments. If not supplied, the program will receive an empty\n  object as its input.\n\n### Output\n\n- `result` (map[string]string) - A map of string values returned from the external program.\n\n\n## Processing JSON in shell scripts\n\nSince the external data source protocol uses JSON, it is recommended to use\nthe utility [`jq`](https://stedolan.github.io/jq/) to translate to and from\nJSON in a robust way when implementing a data source in a shell scripting\nlanguage.\n\nThe following example shows some input/output boilerplate code for a\ndata source implemented in bash:\n\n```bash\n#!/bin/bash\n# Exit if any of the intermediate steps fail\nset -e\n# Extract \"foo\" and \"baz\" arguments from the input into\n# FOO and BAZ shell variables.\n# jq will ensure that the values are properly quoted\n# and escaped for consumption by the shell.\neval \"$(jq -r '@sh \"FOO=\\(.foo) BAZ=\\(.baz)\"')\"\n# Placeholder for whatever data-fetching logic your script implements\nFOOBAZ=\"$FOO $BAZ\"\n# Safely produce a JSON object containing the result value.\n# jq will ensure that the value is properly quoted\n# and escaped to produce a valid JSON string.\njq -n --arg foobaz \"$FOOBAZ\" '{\"foobaz\":$foobaz}'\n```\n","sourceUrl":"https://github.com/joomcode/packer-plugin-external/blob/main/docs/datasources/external.mdx"},"pluginData":{"title":"External","path":"external","repo":"joomcode/packer-plugin-external","version":"latest","sourceBranch":"main","pluginTier":"community","files":[]},"fullPath":"/packer/plugins/datasources/external/external","id":"sidebar-nav-item-19"},{"title":"External Raw","path":"datasources/external/raw","remoteFile":{"filePath":"docs/datasources/raw.mdx"},"pluginData":{"title":"External","path":"external","repo":"joomcode/packer-plugin-external","version":"latest","sourceBranch":"main","pluginTier":"community","files":[]},"fullPath":"/packer/plugins/datasources/external/raw","id":"sidebar-nav-item-20"}],"id":"sidebar-nav-item-17"}],"id":"sidebar-nav-item-16"},{"title":"Gridscale","routes":[{"title":"Builders","routes":[{"title":"gridscale","path":"builders/gridscale","remoteFile":{"filePath":"docs/builders/gridscale.mdx"},"pluginData":{"title":"Gridscale","path":"gridscale","repo":"gridscale/packer-plugin-gridscale","version":"latest","pluginTier":"verified","isHcpPackerReady":false,"files":[]},"fullPath":"/packer/plugins/builders/gridscale","id":"sidebar-nav-item-23"}],"id":"sidebar-nav-item-22"}],"id":"sidebar-nav-item-21"},{"title":"IPSW","routes":[{"title":"Data Sources","routes":[{"title":"IPSW","path":"datasources/ipsw","remoteFile":{"filePath":"docs/datasources/ipsw.mdx"},"pluginData":{"title":"IPSW","path":"ipsw","repo":"torarnv/packer-plugin-ipsw","version":"latest","sourceBranch":"main","pluginTier":"community","files":[]},"fullPath":"/packer/plugins/datasources/ipsw","id":"sidebar-nav-item-26"}],"id":"sidebar-nav-item-25"}],"id":"sidebar-nav-item-24"},{"title":"Kamatera","routes":[{"title":"Builders","routes":[{"title":"Kamatera","path":"builders/kamatera","remoteFile":{"filePath":"docs/builders/kamatera.mdx"},"pluginData":{"title":"Kamatera","path":"kamatera","repo":"kamatera/packer-plugin-kamatera","pluginTier":"community","version":"latest","files":[]},"fullPath":"/packer/plugins/builders/kamatera","id":"sidebar-nav-item-29"}],"id":"sidebar-nav-item-28"}],"id":"sidebar-nav-item-27"},{"title":"Libvirt","routes":[{"title":"Builders","routes":[{"title":"Libvirt","path":"builders/libvirt","remoteFile":{"filePath":"docs/builders/libvirt.mdx"},"pluginData":{"title":"Libvirt","path":"libvirt","repo":"thomasklein94/packer-plugin-libvirt","pluginTier":"community","version":"latest","files":[]},"fullPath":"/packer/plugins/builders/libvirt","id":"sidebar-nav-item-32"}],"id":"sidebar-nav-item-31"}],"id":"sidebar-nav-item-30"},{"title":"Nutanix","routes":[{"title":"Builders","routes":[{"title":"Overview","path":"builders/nutanix","remoteFile":{"filePath":"docs/builders/index.mdx"},"pluginData":{"title":"Nutanix","path":"nutanix","repo":"nutanix-cloud-native/packer-plugin-nutanix","version":"latest","pluginTier":"verified","sourceBranch":"main","files":[]},"fullPath":"/packer/plugins/builders/nutanix","id":"sidebar-nav-item-35"},{"title":"Nutanix","path":"builders/nutanix/nutanix","remoteFile":{"filePath":"docs/builders/nutanix.mdx"},"pluginData":{"title":"Nutanix","path":"nutanix","repo":"nutanix-cloud-native/packer-plugin-nutanix","version":"latest","pluginTier":"verified","sourceBranch":"main","files":[]},"fullPath":"/packer/plugins/builders/nutanix/nutanix","id":"sidebar-nav-item-36"}],"id":"sidebar-nav-item-34"}],"id":"sidebar-nav-item-33"},{"title":"Outscale","routes":[{"title":"Builders","routes":[{"title":"Overview","path":"builders/outscale","remoteFile":{"filePath":"docs/builders/index.mdx"},"pluginData":{"title":"Outscale","path":"outscale","repo":"outscale/packer-plugin-outscale","version":"latest","pluginTier":"verified","isHcpPackerReady":true,"files":[]},"fullPath":"/packer/plugins/builders/outscale","id":"sidebar-nav-item-39"},{"title":"BSU","path":"builders/outscale/outscale-bsu","remoteFile":{"filePath":"docs/builders/outscale-bsu.mdx"},"pluginData":{"title":"Outscale","path":"outscale","repo":"outscale/packer-plugin-outscale","version":"latest","pluginTier":"verified","isHcpPackerReady":true,"files":[]},"fullPath":"/packer/plugins/builders/outscale/outscale-bsu","id":"sidebar-nav-item-40"},{"title":"BSU Surrogate","path":"builders/outscale/outscale-bsusurrogate","remoteFile":{"filePath":"docs/builders/outscale-bsusurrogate.mdx"},"pluginData":{"title":"Outscale","path":"outscale","repo":"outscale/packer-plugin-outscale","version":"latest","pluginTier":"verified","isHcpPackerReady":true,"files":[]},"fullPath":"/packer/plugins/builders/outscale/outscale-bsusurrogate","id":"sidebar-nav-item-41"},{"title":"BSU Volume","path":"builders/outscale/outscale-bsuvolume","remoteFile":{"filePath":"docs/builders/outscale-bsuvolume.mdx"},"pluginData":{"title":"Outscale","path":"outscale","repo":"outscale/packer-plugin-outscale","version":"latest","pluginTier":"verified","isHcpPackerReady":true,"files":[]},"fullPath":"/packer/plugins/builders/outscale/outscale-bsuvolume","id":"sidebar-nav-item-42"},{"title":"chroot","path":"builders/outscale/outscale-chroot","remoteFile":{"filePath":"docs/builders/outscale-chroot.mdx"},"pluginData":{"title":"Outscale","path":"outscale","repo":"outscale/packer-plugin-outscale","version":"latest","pluginTier":"verified","isHcpPackerReady":true,"files":[]},"fullPath":"/packer/plugins/builders/outscale/outscale-chroot","id":"sidebar-nav-item-43"}],"id":"sidebar-nav-item-38"},{"title":"Data Sources","routes":[{"title":"Outscale OMI","path":"datasources/outscale","remoteFile":{"filePath":"docs/datasources/omi.mdx"},"pluginData":{"title":"Outscale","path":"outscale","repo":"outscale/packer-plugin-outscale","version":"latest","pluginTier":"verified","isHcpPackerReady":true,"files":[]},"fullPath":"/packer/plugins/datasources/outscale","id":"sidebar-nav-item-45"}],"id":"sidebar-nav-item-44"}],"id":"sidebar-nav-item-37"},{"title":"UCloud","routes":[{"title":"Builders","routes":[{"title":"UCloud","path":"builders/ucloud","remoteFile":{"filePath":"docs/builders/uhost.mdx"},"pluginData":{"title":"UCloud","path":"ucloud","repo":"ucloud/packer-plugin-ucloud","version":"latest","pluginTier":"community","files":[]},"fullPath":"/packer/plugins/builders/ucloud","id":"sidebar-nav-item-48"}],"id":"sidebar-nav-item-47"},{"title":"Post-Processors","routes":[{"title":"UCloud Import","path":"post-processors/ucloud","remoteFile":{"filePath":"docs/post-processors/import.mdx"},"pluginData":{"title":"UCloud","path":"ucloud","repo":"ucloud/packer-plugin-ucloud","version":"latest","pluginTier":"community","files":[]},"fullPath":"/packer/plugins/post-processors/ucloud","id":"sidebar-nav-item-50"}],"id":"sidebar-nav-item-49"}],"id":"sidebar-nav-item-46"},{"title":"Volcengine","routes":[{"title":"Builders","routes":[{"title":"Volcengine ECS","path":"builders/volcengine","remoteFile":{"filePath":"docs/builders/volcengine-ecs.mdx"},"pluginData":{"title":"Volcengine","path":"volcengine","repo":"volcengine/packer-plugin-volcengine","pluginTier":"community","version":"latest","files":[]},"fullPath":"/packer/plugins/builders/volcengine","id":"sidebar-nav-item-53"}],"id":"sidebar-nav-item-52"}],"id":"sidebar-nav-item-51"},{"title":"Vultr","routes":[{"title":"Builders","routes":[{"title":"Vultr","path":"builders/vultr","remoteFile":{"filePath":"docs/builders/vultr.mdx"},"pluginData":{"title":"Vultr","path":"vultr","repo":"vultr/packer-plugin-vultr","pluginTier":"community","version":"latest","files":[]},"fullPath":"/packer/plugins/builders/vultr","id":"sidebar-nav-item-56"}],"id":"sidebar-nav-item-55"}],"id":"sidebar-nav-item-54"},{"title":"Ksyun","routes":[{"title":"Builders","routes":[{"title":"Epc","path":"builders/ksyun/epc","remoteFile":{"filePath":"docs/builders/epc.mdx"},"pluginData":{"title":"Ksyun","path":"ksyun","repo":"kingsoftcloud/packer-plugin-ksyun","pluginTier":"community","version":"latest","files":[]},"fullPath":"/packer/plugins/builders/ksyun/epc","id":"sidebar-nav-item-59"},{"title":"Instance(KEC)","path":"builders/ksyun/kec","remoteFile":{"filePath":"docs/builders/kec.mdx"},"pluginData":{"title":"Ksyun","path":"ksyun","repo":"kingsoftcloud/packer-plugin-ksyun","pluginTier":"community","version":"latest","files":[]},"fullPath":"/packer/plugins/builders/ksyun/kec","id":"sidebar-nav-item-60"}],"id":"sidebar-nav-item-58"},{"title":"Data Sources","routes":[{"title":"Ksyun KMI","path":"datasources/ksyun","remoteFile":{"filePath":"docs/datasources/kmi.mdx"},"pluginData":{"title":"Ksyun","path":"ksyun","repo":"kingsoftcloud/packer-plugin-ksyun","pluginTier":"community","version":"latest","files":[]},"fullPath":"/packer/plugins/datasources/ksyun","id":"sidebar-nav-item-62"}],"id":"sidebar-nav-item-61"}],"id":"sidebar-nav-item-57"}],"title":"Plugins","visuallyHideTitle":true}],"mainWidth":"narrow"},"outlineItems":[{"title":"External","url":"#external","dataHeapTrack":"toc-list-item-index-0"},{"title":"External Program Protocol","url":"#external-program-protocol","dataHeapTrack":"toc-list-item-index-1"},{"title":"Argument Reference","url":"#argument-reference","dataHeapTrack":"toc-list-item-index-2"},{"title":"Processing JSON in shell scripts","url":"#processing-json-in-shell-scripts","dataHeapTrack":"toc-list-item-index-3"}],"metadata":{"title":"External - Data Sources","description":"The json data source is used to communicate with external commands using JSON protocol.\n"},"mdxSource":{"compiledSource":"var c=Object.defineProperty,d=Object.defineProperties;var N=Object.getOwnPropertyDescriptors;var p=Object.getOwnPropertySymbols;var o=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable;var l=(e,n,s)=>n in e?c(e,n,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[n]=s,a=(e,n)=>{for(var s in n||(n={}))o.call(n,s)&&l(e,s,n[s]);if(p)for(var s of p(n))r.call(n,s)&&l(e,s,n[s]);return e},i=(e,n)=>d(e,N(n));var m=(e,n)=>{var s={};for(var t in e)o.call(e,t)&&n.indexOf(t)<0&&(s[t]=e[t]);if(e!=null&&p)for(var t of p(e))n.indexOf(t)<0&&r.call(e,t)&&(s[t]=e[t]);return s};const makeShortcode=e=>function(s){return console.warn(\"Component \"+e+\" was not imported, exported, or provided by MDXProvider as global scope\"),mdx(\"div\",a({},s))},BadgesHeader=makeShortcode(\"BadgesHeader\"),PluginBadge=makeShortcode(\"PluginBadge\"),Badge=makeShortcode(\"Badge\"),layoutProps={},MDXLayout=\"wrapper\";function MDXContent(s){var t=s,{components:e}=t,n=m(t,[\"components\"]);return mdx(MDXLayout,i(a(a({},layoutProps),n),{components:e,mdxType:\"MDXLayout\"}),mdx(BadgesHeader,{mdxType:\"BadgesHeader\"},mdx(PluginBadge,{type:\"community\",mdxType:\"PluginBadge\"}),mdx(Badge,{href:\"https://github.com/joomcode/packer-plugin-external/releases/tag/v0.0.2\",label:\"v0.0.2\",theme:\"light-gray\",mdxType:\"Badge\"})),mdx(\"h1\",a({},{className:\"g-type-display-2\",id:\"external\"}),mdx(\"a\",a({parentName:\"h1\"},{className:\"__permalink-h\",href:\"#external\",\"aria-label\":\"external permalink\"}),\"\\xBB\"),\"External\"),mdx(\"p\",a({},{className:\"g-type-long-body\"}),\"Type: \",mdx(\"inlineCode\",{parentName:\"p\"},\"external\")),mdx(\"p\",a({},{className:\"g-type-long-body\"}),\"The \",mdx(\"inlineCode\",{parentName:\"p\"},\"external\"),` data source allows an external program implementing a specific\nprotocol (defined below) to act as a data source, exposing arbitrary\ndata for use elsewhere in the Packer configuration.`),mdx(\"div\",a({},{className:\"alert alert-warning g-type-body\"}),mdx(\"p\",a({parentName:\"div\"},{className:\"g-type-long-body\"}),\"\",mdx(\"strong\",{parentName:\"p\"},\"Warning\"),` This mechanism is provided as an \"escape hatch\" for exceptional\nsituations where a first-class Packer provider is not more appropriate.\nIts capabilities are limited in comparison to a true data source, and\nimplementing a data source via an external program is likely to hurt the\nportability of your Packer configuration by creating dependencies on\nexternal programs and libraries that may not be available (or may need to\nbe used differently) on different operating systems.`)),mdx(\"h3\",a({},{className:\"g-type-display-4\",id:\"example-usage\"}),mdx(\"a\",a({parentName:\"h3\"},{className:\"__permalink-h\",href:\"#example-usage\",\"aria-label\":\"example usage permalink\"}),\"\\xBB\"),\"Example Usage\"),mdx(\"pre\",a({},{className:\"language-hcl\"}),mdx(\"code\",a({parentName:\"pre\"},{className:\"language-hcl\"}),mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"data \",mdx(\"span\",a({parentName:\"span\"},{className:\"token type variable\"}),'\"external\"')),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'\"example\"'),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",a({parentName:\"code\"},{className:\"token property\"}),\"program\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'\"jq\"'),\", \",mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'\"{ \\\\\"foo\\\\\": .key1 }\"'),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),`\n`,\"  \",mdx(\"span\",a({parentName:\"code\"},{className:\"token property\"}),\"query\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"    \",mdx(\"span\",a({parentName:\"code\"},{className:\"token property\"}),\"key1\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'\"val1\"'),`\n`,\"  \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,`\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"locals\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",a({parentName:\"code\"},{className:\"token property\"}),\"result\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" data.external.example.result\",`\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,`\n`,\"source \",mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'\"null\"'),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'\"example\"'),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",a({parentName:\"code\"},{className:\"token property\"}),\"communicator\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'\"none\"'),`\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,`\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"build\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",a({parentName:\"code\"},{className:\"token property\"}),\"sources\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'\"source.null.example\"'),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),`\n`,`\n`,\"  \",mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"provisioner\",mdx(\"span\",a({parentName:\"span\"},{className:\"token type variable\"}),' \"shell-local\" ')),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"    \",mdx(\"span\",a({parentName:\"code\"},{className:\"token property\"}),\"inline\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),`\n`,\"      \",mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'\"echo ',mdx(\"span\",a({parentName:\"span\"},{className:\"token interpolation\"}),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"$\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"{\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token keyword\"}),\"local\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\".\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token type variable\"}),\"result\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"[\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token string\"}),'\"foo\"'),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"]\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"}\")),' == val1\"'),\",\",`\n`,\"    \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),`\n`,\"  \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`)),mdx(\"h2\",a({},{className:\"g-type-display-3\",id:\"external-program-protocol\"}),mdx(\"a\",a({parentName:\"h2\"},{className:\"__permalink-h\",href:\"#external-program-protocol\",\"aria-label\":\"external program protocol permalink\"}),\"\\xBB\"),\"External Program Protocol\"),mdx(\"p\",a({},{className:\"g-type-long-body\"}),\"The external program described by the \",mdx(\"inlineCode\",{parentName:\"p\"},\"program\"),` attribute must implement a\nspecific protocol for interacting with Packer, as follows.`),mdx(\"p\",a({},{className:\"g-type-long-body\"}),\"The program must read all the data passed to it on \",mdx(\"inlineCode\",{parentName:\"p\"},\"stdin\"),`, and parse\nit as a JSON object. The JSON object contains the contents of the `,mdx(\"inlineCode\",{parentName:\"p\"},\"query\"),`\nargument and its values will always be strings.`),mdx(\"p\",a({},{className:\"g-type-long-body\"}),\"The program must then produce a valid JSON object on \",mdx(\"inlineCode\",{parentName:\"p\"},\"stdout\"),`, which will\nbe used to populate the `,mdx(\"inlineCode\",{parentName:\"p\"},\"result\"),` attribute exported to the rest of the\nPacker configuration. This JSON object must again have all of its\nvalues as strings. On successful completion it must exit with status zero.`),mdx(\"p\",a({},{className:\"g-type-long-body\"}),`If the program encounters an error and is unable to produce a result, it\nmust print a human-readable error message (ideally a single line) to `,mdx(\"inlineCode\",{parentName:\"p\"},\"stderr\"),`\nand exit with a non-zero status. Any data on `,mdx(\"inlineCode\",{parentName:\"p\"},\"stdout\"),` is ignored if the\nprogram returns a non-zero status.`),mdx(\"p\",a({},{className:\"g-type-long-body\"}),`All environment variables visible to the Packer process are passed through\nto the child program.`),mdx(\"h2\",a({},{className:\"g-type-display-3\",id:\"argument-reference\"}),mdx(\"a\",a({parentName:\"h2\"},{className:\"__permalink-h\",href:\"#argument-reference\",\"aria-label\":\"argument reference permalink\"}),\"\\xBB\"),\"Argument Reference\"),mdx(\"h3\",a({},{className:\"g-type-display-4\",id:\"required\"}),mdx(\"a\",a({parentName:\"h3\"},{className:\"__permalink-h\",href:\"#required\",\"aria-label\":\"required permalink\"}),\"\\xBB\"),\"Required\"),mdx(\"ul\",null,mdx(\"li\",a({parentName:\"ul\"},{className:\"g-type-long-body\"}),mdx(\"a\",a({parentName:\"li\"},{id:\"command\",className:\"__target-lic\",\"aria-hidden\":\"true\"})),mdx(\"a\",a({parentName:\"li\"},{href:\"#command\",\"aria-label\":\"command permalink\",className:\"__permalink-lic\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"command\")),` ([]string) - A list of strings, whose first element is the program\nto run and whose subsequent elements are optional command line arguments\nto the program. Packer does not execute the program through a shell, so\nit is not necessary to escape shell metacharacters nor add quotes around\narguments containing spaces.`)),mdx(\"h3\",a({},{className:\"g-type-display-4\",id:\"optional\"}),mdx(\"a\",a({parentName:\"h3\"},{className:\"__permalink-h\",href:\"#optional\",\"aria-label\":\"optional permalink\"}),\"\\xBB\"),\"Optional\"),mdx(\"ul\",null,mdx(\"li\",a({parentName:\"ul\"},{className:\"g-type-long-body\"}),mdx(\"a\",a({parentName:\"li\"},{id:\"working_dir\",className:\"__target-lic\",\"aria-hidden\":\"true\"})),mdx(\"a\",a({parentName:\"li\"},{href:\"#working_dir\",\"aria-label\":\"working_dir permalink\",className:\"__permalink-lic\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"working_dir\")),` (string) - Working directory of the program.\nIf not supplied, the program will run in the current directory.`),mdx(\"li\",a({parentName:\"ul\"},{className:\"g-type-long-body\"}),mdx(\"a\",a({parentName:\"li\"},{id:\"query\",className:\"__target-lic\",\"aria-hidden\":\"true\"})),mdx(\"a\",a({parentName:\"li\"},{href:\"#query\",\"aria-label\":\"query permalink\",className:\"__permalink-lic\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"query\")),\" (map\",\"[string]\",`string) - A map of string values to pass to the external program\nas the query arguments. If not supplied, the program will receive an empty\nobject as its input.`)),mdx(\"h3\",a({},{className:\"g-type-display-4\",id:\"output\"}),mdx(\"a\",a({parentName:\"h3\"},{className:\"__permalink-h\",href:\"#output\",\"aria-label\":\"output permalink\"}),\"\\xBB\"),\"Output\"),mdx(\"ul\",null,mdx(\"li\",a({parentName:\"ul\"},{className:\"g-type-long-body\"}),mdx(\"a\",a({parentName:\"li\"},{id:\"result\",className:\"__target-lic\",\"aria-hidden\":\"true\"})),mdx(\"a\",a({parentName:\"li\"},{href:\"#result\",\"aria-label\":\"result permalink\",className:\"__permalink-lic\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"result\")),\" (map\",\"[string]\",\"string) - A map of string values returned from the external program.\")),mdx(\"h2\",a({},{className:\"g-type-display-3\",id:\"processing-json-in-shell-scripts\"}),mdx(\"a\",a({parentName:\"h2\"},{className:\"__permalink-h\",href:\"#processing-json-in-shell-scripts\",\"aria-label\":\"processing json in shell scripts permalink\"}),\"\\xBB\"),\"Processing JSON in shell scripts\"),mdx(\"p\",a({},{className:\"g-type-long-body\"}),`Since the external data source protocol uses JSON, it is recommended to use\nthe utility `,mdx(\"a\",a({parentName:\"p\"},{href:\"https://stedolan.github.io/jq/\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"jq\")),` to translate to and from\nJSON in a robust way when implementing a data source in a shell scripting\nlanguage.`),mdx(\"p\",a({},{className:\"g-type-long-body\"}),`The following example shows some input/output boilerplate code for a\ndata source implemented in bash:`),mdx(\"pre\",a({},{className:\"language-bash\"}),mdx(\"code\",a({parentName:\"pre\"},{className:\"language-bash\"}),mdx(\"span\",a({parentName:\"code\"},{className:\"token shebang important\"}),\"#!/bin/bash\"),`\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token comment\"}),\"# Exit if any of the intermediate steps fail\"),`\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token builtin class-name\"}),\"set\"),\" -e\",`\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token comment\"}),'# Extract \"foo\" and \"baz\" arguments from the input into'),`\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token comment\"}),\"# FOO and BAZ shell variables.\"),`\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token comment\"}),\"# jq will ensure that the values are properly quoted\"),`\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token comment\"}),\"# and escaped for consumption by the shell.\"),`\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token builtin class-name\"}),\"eval\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),`\"$(jq -r '@sh \"FOO=\\\\(.foo) BAZ=\\\\(.baz)\"`),\"'\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'\"'),`\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),\"# Placeholder for whatever data-fetching logic your script implements\"),`\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'FOOBAZ=\"'),mdx(\"span\",a({parentName:\"code\"},{className:\"token variable\"}),\"$FOO\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token variable\"}),\"$BAZ\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'\"'),`\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),\"# Safely produce a JSON object containing the result value.\"),`\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),\"# jq will ensure that the value is properly quoted\"),`\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),\"# and escaped to produce a valid JSON string.\"),`\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'jq -n --arg foobaz \"'),mdx(\"span\",a({parentName:\"code\"},{className:\"token variable\"}),\"$FOOBAZ\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),`\" '{\"`),'foobaz\":',mdx(\"span\",a({parentName:\"code\"},{className:\"token variable\"}),\"$foobaz\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),\"'\",`\n`)))}MDXContent.isMDXComponent=!0;\n","scope":{}},"product":{"name":"Packer","slug":"packer","algoliaConfig":{"indexName":"product_PACKER","searchOnlyApiKey":"4e1ea7f4bf4335ac43d9f28463e42148"},"analyticsConfig":{"includedDomains":"packer.io www.packer.io","segmentWriteKey":"AjXdfmTTk1I9q9dfyePuDFHBrz1tCO3l"},"datoToken":"88b4984480dad56295a8aadae6caad","metadata":{"title":"Packer by HashiCorp","description":"Packer helps you create golden images for multiple platforms from a single source configuration.","image":"https://www.packer.io/packer-public/img/og-image.png","icon":[{"href":"/packer-public/_favicon.ico"}]},"alertBannerActive":true,"alertBanner":{"tag":"HashiConf","url":"https://hashiconf.com/2023?utm_source=direct&utm_medium=banner&utm_campaign=23Q3_HASHICONFGLOBAL_EVENT&utm_content=&utm_offer=event","text":"Our community conference is taking place in San Francisco and online October 10-12.","linkText":"Register now","expirationDate":""},"version":"1.7.10","basePaths":["docs","guides","intro","downloads"],"rootDocsPaths":[{"iconName":"docs","name":"Documentation","path":"docs"},{"iconName":"guide","name":"Guides","path":"guides"},{"iconName":"plug","name":"Plugins","path":"plugins"}],"integrationsConfig":{"description":"A curated collection of official, partner, and community Packer Integrations."},"currentRootDocsPath":{"iconName":"plug","name":"Plugins","path":"plugins"}}},"__N_SSG":true}