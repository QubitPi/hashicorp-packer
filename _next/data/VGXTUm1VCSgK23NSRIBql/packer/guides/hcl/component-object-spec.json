{"pageProps":{"layoutProps":{"breadcrumbLinks":[{"title":"Developer","url":"/"},{"title":"Packer","url":"/packer"},{"title":"Guides","url":"/packer/guides","isCurrentPage":false},{"title":"HCL guides","url":"/packer/guides/hcl"},{"title":"Making a plugin HCL2 enabled","url":"/packer/guides/hcl/component-object-spec","isCurrentPage":true}],"sidebarNavDataLevels":[{"levelButtonProps":{"levelDownButtonText":"Packer Home"},"menuItems":[{"leadingIconName":"home","title":"HashiCorp Developer","href":"/"},{"leadingIconName":"guide","title":"Tutorials","href":"/tutorials"},{"divider":true},{"heading":"Products"},{"leadingIconName":"hcp","title":"HashiCorp Cloud Platform","href":"/hcp"},{"leadingIconName":"terraform","title":"Terraform","href":"/terraform"},{"leadingIconName":"packer","title":"Packer","href":"/packer"},{"leadingIconName":"consul","title":"Consul","href":"/consul"},{"leadingIconName":"vault","title":"Vault","href":"/vault"},{"leadingIconName":"boundary","title":"Boundary","href":"/boundary"},{"leadingIconName":"nomad","title":"Nomad","href":"/nomad"},{"leadingIconName":"waypoint","title":"Waypoint","href":"/waypoint"},{"leadingIconName":"vagrant","title":"Vagrant","href":"/vagrant"}],"showFilterInput":false,"title":"Main Menu"},{"levelButtonProps":{"levelUpButtonText":"Main Menu","levelDownButtonText":"Previous"},"menuItems":[{"title":"Packer","fullPath":"/packer","theme":"packer"},{"title":"Install","fullPath":"/packer/downloads"},{"title":"Tutorials","fullPath":"/packer/tutorials"},{"title":"Documentation","fullPath":"/packer/docs"},{"title":"Guides","fullPath":"/packer/guides"},{"title":"Plugins","fullPath":"/packer/plugins"},{"title":"Integrations","fullPath":"/packer/integrations"}],"showFilterInput":false,"title":"Packer","visuallyHideTitle":true},{"backToLinkProps":{"text":"Packer Home","href":"/packer"},"levelButtonProps":{"levelUpButtonText":"Packer Home"},"menuItems":[{"title":"Guides","fullPath":"/packer/guides","theme":"packer"},{"title":"Upgrade Your Plugin to use the Packer plugin sdk","path":"1.7-plugin-upgrade","filePath":"../content/guides/1.7-plugin-upgrade.mdx","fullPath":"/packer/guides/1.7-plugin-upgrade","id":"sidebar-nav-item-0"},{"title":"Upgrade Your Template to use Packer init","path":"1.7-template-upgrade","filePath":"../content/guides/1.7-template-upgrade.mdx","fullPath":"/packer/guides/1.7-template-upgrade","id":"sidebar-nav-item-1"},{"title":"HCL guides","routes":[{"title":"Overview","path":"hcl","filePath":"../content/guides/hcl/index.mdx","fullPath":"/packer/guides/hcl","id":"sidebar-nav-item-3"},{"title":"Variables","path":"hcl/variables","filePath":"../content/guides/hcl/variables.mdx","fullPath":"/packer/guides/hcl/variables","id":"sidebar-nav-item-4"},{"title":"Upgrade Packer JSON Template to HCL2","href":"https://learn.hashicorp.com/tutorials/packer/hcl2-upgrade","id":"sidebar-nav-item-5"},{"title":"Making a plugin HCL2 enabled","path":"hcl/component-object-spec","filePath":"../content/guides/hcl/component-object-spec.mdx","fullPath":"/packer/guides/hcl/component-object-spec","id":"sidebar-nav-item-6"}],"id":"sidebar-nav-item-2"},{"title":"Automatic OS Installs","routes":[{"title":"Overview","path":"automatic-operating-system-installs","filePath":"../content/guides/automatic-operating-system-installs/index.mdx","fullPath":"/packer/guides/automatic-operating-system-installs","id":"sidebar-nav-item-8"},{"title":"Unattended Installation for Windows","path":"automatic-operating-system-installs/autounattend_windows","filePath":"../content/guides/automatic-operating-system-installs/autounattend_windows.mdx","fullPath":"/packer/guides/automatic-operating-system-installs/autounattend_windows","id":"sidebar-nav-item-9"},{"title":"Unattended Installation for Debian","path":"automatic-operating-system-installs/preseed_ubuntu","filePath":"../content/guides/automatic-operating-system-installs/preseed_ubuntu.mdx","fullPath":"/packer/guides/automatic-operating-system-installs/preseed_ubuntu","id":"sidebar-nav-item-10"}],"id":"sidebar-nav-item-7"},{"title":"Build Immutable Infrastructure with Packer in CI/CD","routes":[{"title":"Overview","path":"packer-on-cicd","filePath":"../content/guides/packer-on-cicd/index.mdx","fullPath":"/packer/guides/packer-on-cicd","id":"sidebar-nav-item-12"},{"title":"Build Images in CI/CD","path":"packer-on-cicd/build-image-in-cicd","filePath":"../content/guides/packer-on-cicd/build-image-in-cicd.mdx","fullPath":"/packer/guides/packer-on-cicd/build-image-in-cicd","id":"sidebar-nav-item-13"},{"title":"Build a VirtualBox Image with Packer in TeamCity","path":"packer-on-cicd/build-virtualbox-image","filePath":"../content/guides/packer-on-cicd/build-virtualbox-image.mdx","fullPath":"/packer/guides/packer-on-cicd/build-virtualbox-image","id":"sidebar-nav-item-14"},{"title":"Pipelineing Builds","path":"packer-on-cicd/pipelineing-builds","filePath":"../content/guides/packer-on-cicd/pipelineing-builds.mdx","fullPath":"/packer/guides/packer-on-cicd/pipelineing-builds","id":"sidebar-nav-item-15"},{"title":"Trigger Terraform Enterprise runs","path":"packer-on-cicd/trigger-tfe","filePath":"../content/guides/packer-on-cicd/trigger-tfe.mdx","fullPath":"/packer/guides/packer-on-cicd/trigger-tfe","id":"sidebar-nav-item-16"},{"title":"Upload a VirtualBox Image to S3","path":"packer-on-cicd/upload-images-to-artifact","filePath":"../content/guides/packer-on-cicd/upload-images-to-artifact.mdx","fullPath":"/packer/guides/packer-on-cicd/upload-images-to-artifact","id":"sidebar-nav-item-17"}],"id":"sidebar-nav-item-11"}],"title":"Guides","visuallyHideTitle":true}],"mainWidth":"narrow","githubFileUrl":"https://github.com/hashicorp/packer/blob/main/website/../content/guides/hcl/component-object-spec.mdx"},"metadata":{"title":"Generating code for config spec.","description":"Learn how to generate the HCL2 configuration of your component easily.","layout":null},"outlineItems":[{"title":"Auto Generate the HCL2 code of a plugin","url":"#auto-generate-the-hcl2-code-of-a-plugin","dataHeapTrack":"toc-list-item-index-0"}],"pageHeading":{"id":"auto-generate-the-hcl2-code-of-a-plugin","title":"Auto Generate the HCL2 code of a plugin"},"mdxSource":{"compiledSource":"var m=Object.defineProperty,u=Object.defineProperties;var d=Object.getOwnPropertyDescriptors;var p=Object.getOwnPropertySymbols;var i=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable;var l=(a,n,o)=>n in a?m(a,n,{enumerable:!0,configurable:!0,writable:!0,value:o}):a[n]=o,e=(a,n)=>{for(var o in n||(n={}))i.call(n,o)&&l(a,o,n[o]);if(p)for(var o of p(n))s.call(n,o)&&l(a,o,n[o]);return a},c=(a,n)=>u(a,d(n));var r=(a,n)=>{var o={};for(var t in a)i.call(a,t)&&n.indexOf(t)<0&&(o[t]=a[t]);if(a!=null&&p)for(var t of p(a))n.indexOf(t)<0&&s.call(a,t)&&(o[t]=a[t]);return o};const layoutProps={},MDXLayout=\"wrapper\";function MDXContent(o){var t=o,{components:a}=t,n=r(t,[\"components\"]);return mdx(MDXLayout,c(e(e({},layoutProps),n),{components:a,mdxType:\"MDXLayout\"}),mdx(\"p\",null,`From v1.5, Packer can be configured using HCL2. Because Packer has so many\nbuilders, provisioners, and post-processors, we created a on code generation\ntool to add the HCL2-enabling code more easily. You can use this code generator\nto create the HCL2 spec code of your custom plugin simply.\nIt's a Go binary package made available through the Packer plugin SDK`),mdx(\"p\",null,\"Say you want to configure the \",mdx(\"inlineCode\",{parentName:\"p\"},\"Config\"),\" struct of a \",mdx(\"inlineCode\",{parentName:\"p\"},\"Builder\"),` in a package\nlocated in `,mdx(\"inlineCode\",{parentName:\"p\"},\"my/example-plugin/config.go\"),`. Here are some simple steps you can\nfollow to make it HCL2 enabled:`),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\"},\"run \",mdx(\"inlineCode\",{parentName:\"p\"},\"go install github.com/hashicorp/packer-plugin-sdk/cmd/packer-sdc@latest\"))),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\"},\"Add \",mdx(\"inlineCode\",{parentName:\"p\"},\"//go:generate packer-sdc mapstructure-to-hcl2 -type Config\"),` at the top of\n`,mdx(\"inlineCode\",{parentName:\"p\"},\"config.go\"))),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\"},\"run \",mdx(\"inlineCode\",{parentName:\"p\"},\"go generate ./my/example-plugin/...\")),mdx(\"p\",{parentName:\"li\"},\"This will generate a \",mdx(\"inlineCode\",{parentName:\"p\"},\"my/example-plugin/config.hcl2spec.go\"),` file containing\nthe configuration fields of `,mdx(\"inlineCode\",{parentName:\"p\"},\"Config\"),\".\")),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\"},\"Make sure that all the nested structs of \",mdx(\"inlineCode\",{parentName:\"p\"},\"Config\"),` are also auto generated the\nsame way.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\"},`Now we only need to make your Builder implement the interface by adding the\nfollowing snippet:`),mdx(\"pre\",e({parentName:\"li\"},{className:\"language-go\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-go\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"func\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),\"b \",mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\"*\"),\"Builder\",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token function\"}),\"ConfigSpec\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),\" hcldec\",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),\"ObjectSpec \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"return\"),\" b\",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),\"config\",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token function\"}),\"FlatMapstructure\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token function\"}),\"HCL2Spec\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`)),mdx(\"p\",{parentName:\"li\"},`From now on every time you add or change a field of Config you will need to\nrun the `,mdx(\"inlineCode\",{parentName:\"p\"},\"go generate\"),\" command again.\"))),mdx(\"p\",null,\"A good example of this is the \",mdx(\"a\",e({parentName:\"p\"},{href:\"https://github.com/hashicorp/packer-plugin-amazon/blob/main/builder/ebs/builder.go\"}),\"Config struct of the amazon-ebs builder\")))}MDXContent.isMDXComponent=!0;\n","scope":{"version":"latest"}},"product":{"name":"Packer","slug":"packer","algoliaConfig":{"indexName":"product_PACKER","searchOnlyApiKey":"4e1ea7f4bf4335ac43d9f28463e42148"},"analyticsConfig":{"includedDomains":"packer.io www.packer.io","segmentWriteKey":"AjXdfmTTk1I9q9dfyePuDFHBrz1tCO3l"},"datoToken":"88b4984480dad56295a8aadae6caad","metadata":{"title":"Packer by HashiCorp","description":"Packer helps you create golden images for multiple platforms from a single source configuration.","image":"https://www.packer.io/packer-public/img/og-image.png","icon":[{"href":"/packer-public/_favicon.ico"}]},"alertBannerActive":true,"alertBanner":{"tag":"HashiConf","url":"https://hashiconf.com/2023?utm_source=direct&utm_medium=banner&utm_campaign=23Q3_HASHICONFGLOBAL_EVENT&utm_content=&utm_offer=event","text":"Our community conference is taking place in San Francisco and online October 10-12.","linkText":"Register now","expirationDate":""},"version":"1.7.10","basePaths":["docs","guides","intro","downloads"],"rootDocsPaths":[{"iconName":"docs","name":"Documentation","path":"docs"},{"iconName":"guide","name":"Guides","path":"guides"},{"iconName":"plug","name":"Plugins","path":"plugins"}],"integrationsConfig":{"description":"A curated collection of official, partner, and community Packer Integrations."},"currentRootDocsPath":{"iconName":"guide","name":"Guides","path":"guides"}},"projectName":null,"versions":null},"__N_SSG":true}